name: æ„å»ºå¹¶æ¨é€ Docker é•œåƒåˆ° Docker Hub


on:
  push:
    branches: [ main ]
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v3

      - name: è®¾ç½® Docker Buildx
        uses: docker/setup-buildx-action@v2

      - name: ç™»å½• Docker Hub
        uses: docker/login-action@v2
        with:
          username: wzxwhxcz
          password: ${{ secrets.DOCKER_TOKEN }}

      - name: æ„å»ºå¹¶æ¨é€é•œåƒ
        uses: docker/build-push-action@v4
        with:
          context: .
          file: ./Dockerfile
          platforms: linux/amd64
          push: true
          tags: |
            wzxwhxcz/vcptoolbox:latest
            wzxwhxcz/vcptoolbox:${{ github.sha }}
          cache-from: type=gha
          cache-to: type=gha,mode=max

      - name: è¾“å‡ºé•œåƒä¿¡æ¯
        run: |
          echo "âœ… Docker é•œåƒæ„å»ºæˆåŠŸï¼"
          echo "ğŸ“¦ é•œåƒå·²æ¨é€åˆ°ï¼š"
          echo "  - wzxwhxcz/vcptoolbox:latest"
          echo "  - wzxwhxcz/vcptoolbox:${{ github.sha }}"
          echo ""
          echo "ğŸš€ è¿è¡Œé•œåƒï¼š"
          echo "docker run -d -p 6005:6005 wzxwhxcz/vcptoolbox:latest"
